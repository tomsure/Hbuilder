/**
 * LBS mTabs
 * Date: 2014-5-10
 * ===================================================
 * opts.mtab 	tabs外围容器/滑动事件对象(一个CSS选择器)
 * opts.mhead 	tabs标题容器/点击对象(一个CSS选择器)
 * opts.mcontent	tabs内容容器/滑动切换对象(一个CSS选择器) 
 * opts.index 	tabs索引(默认0) 指定显示哪个索引的标题、内容
 * opts.current  tabs当前项的类名(默认current)
 * ===================================================
**/
(function(){window.mTabs=function(a){void 0!==typeof a&&(this.mtab=document.querySelector(a.mtab),this.mhead=document.querySelector(a.mhead),this.mcontent=document.querySelector(a.mcontent),this.mheads=this.mhead.children,this.mcontents=this.mcontent.children,this.length=this.mheads.length,1>this.length||(a.index>this.length-1&&(a.index=this.length-1),this.index=this.oIndex=a.index||0,this.current=a.current||"current",this.touch={},this.init()))};mTabs.prototype={init:function(a){this.set();this.initset();
this.bind()},initset:function(){for(var a=0;a<this.length;a++)this.mheads[a].index=a,this.mheads[a].className=this.mheads[a].className.replace(this.current,""),this.mcontents[a].className=this.mcontents[a].className.replace(this.current,"");this.mheads[this.index].className+=" "+this.current;this.mcontents[this.index].className+=" "+this.current;this.mcontent.style.webkitTransform=this.mcontent.style.transform="translate3d("+-this.index*this.width+"px,0,0)"},set:function(){this.width=document.documentElement.clientWidth||
document.body.clientWidth;this.mcontent.style.width=this.length*this.width+"px";for(var a=0;a<this.length;a++)this.mcontents[a].style.width=this.width+"px";this.mcontent.style.webkitTransform=this.mcontent.style.transform="translate3d("+-this.index*this.width+"px,0,0)"},bind:function(){var a=this;this.mtab.addEventListener("touchstart",function(b){a.touchStart(b)},!1);this.mtab.addEventListener("touchmove",function(b){a.touchMove(b)},!1);this.mtab.addEventListener("touchend",function(b){a.touchEnd(b)},
!1);this.mtab.addEventListener("touchcancel",function(b){a.touchEnd(b)},!1);this.mhead.addEventListener("click",function(b){a.touchClick(b)},!1);this.mcontent.addEventListener("webkitTransitionEnd",function(){a.transitionEnd()},!1);window.addEventListener("resize",function(){setTimeout(function(){a.set()},100)},!1);window.addEventListener("orientationchange",function(){setTimeout(function(){a.set()},100)},!1)},touchStart:function(a){this.touch.x=a.touches[0].pageX;this.touch.y=a.touches[0].pageY;
this.touch.time=Date.now();this.touch.disX=0;this.touch.disY=0;this.touch.fixed=""},touchMove:function(a){if("up"!==this.touch.fixed&&(a.stopPropagation(),!(1<a.touches.length||a.scale&&1!==a.scale)&&(this.touch.disX=a.touches[0].pageX-this.touch.x,this.touch.disY=a.touches[0].pageY-this.touch.y,""===this.touch.fixed&&(Math.abs(this.touch.disY)>Math.abs(this.touch.disX)?this.touch.fixed="up":this.touch.fixed="left"),"left"===this.touch.fixed))){a.preventDefault();if(0===this.index&&0<this.touch.disX||
this.index===this.length-1&&0>this.touch.disX)this.touch.disX/=4;this.mcontent.style.webkitTransform=this.mcontent.style.transform="translate3d("+(this.touch.disX-this.index*this.width)+"px,0,0)"}},touchEnd:function(a){if("left"===this.touch.fixed){a=Math.abs(this.touch.disX);this.mcontent.style.webkitTransition=this.mcontent.style.transition="all 100ms";if(100<Date.now()-this.touch.time&&10<a||a>this.width/2)this.touch.time=Date.now(),0<this.touch.disX?this.index--:this.index++,0>this.index&&(this.index=
0),this.index>this.length-1&&(this.index=this.length-1),this.index===this.oIndex&&(this.mcontent.style.webkitTransition=this.mcontent.style.transition="all 300ms"),this.index!==this.oIndex&&this.replace();this.mcontent.style.webkitTransform=this.mcontent.style.transform="translate3d("+-this.index*this.width+"px,0,0)"}},transitionEnd:function(){this.mcontent.style.webkitTransition=this.mcontent.style.transition="all 0ms"},touchClick:function(a){var b=a.target;1===b.nodeType&&void 0!==b.index&&b.index!==
this.index&&(a.preventDefault(),a.stopPropagation(),this.index=b.index,this.mcontent.style.webkitTransition=this.mcontent.style.transition="all 100ms",this.mcontent.style.webkitTransform=this.mcontent.style.transform="translate3d("+-this.index*this.width+"px,0,0)",this.replace())},replace:function(){this.mheads[this.index].className+=" "+this.current;this.mheads[this.oIndex].className=this.mheads[this.oIndex].className.replace(this.current,"").trim();this.mcontents[this.index].className+=" "+this.current;
this.mcontents[this.oIndex].className=this.mcontents[this.oIndex].className.replace(this.current,"").trim();this.oIndex=this.index}}})();